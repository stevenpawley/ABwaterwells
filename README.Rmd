---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# ABwaterwells

<!-- badges: start -->

<!-- badges: end -->

The goal of **ABwaterwells** is to provide an R API to access water well data in Alberta.

## Installation

You can install the development version of ABwaterwells from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("stevenpawley/ABwaterwells")
```

## Example

A basic request of the 'wells' and 'wellreports' tables. Requests are performed in chunks in parallel.

```{r setup}
library(ABwaterwells)
library(future)
library(glue)
plan("multisession")
```

To view the available tables:

```{r get-tables}
awwid_tables()
```


```{r example-1}
# request individual tables
wells <- awwid(
  name = "wells", 
  select = c("gicwellid", "wellid", "longitude", "latitude"),
  filter = "gicwellid gt 40000 and gicwellid lt 41000"
)

reports <- awwid(
  "wellreports", 
  select = c("wellid", "wellreportid", "totaldepthdrilled"),
  filter = "wellreportid gt 40000 and wellreportid lt 41000"
)

lithologies <- awwid(
  name = "lithologies",
  filter = "wellreportid gt 40000 and wellreportid lt 41000"
)

head(lithologies)
```

Data in the [Alberta Water Well Information Database](https://www.alberta.ca/alberta-water-well-information-database) is stored in imperial units. The `metricate` method can be used to automatically convert each table into metric units:

```{r metricate}
# the 'metricate' method automatically converts fields from each table into metric units
lithologies_df <- lithologies |> 
  metricate()

head(lithologies_df)
```

Several predefined queries that perform common processing tasks are also included in the package:

```{r queries}
lithologs <- query_lithologs(wells, reports, lithologies_df)
lithologs
```
